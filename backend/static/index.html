<!DOCTYPE html>
<html>
<head><title>Dashboard</title></head>
<body>

<h2>Submit Hostel Issue</h2>

<form id="issueForm">
  <input placeholder="Name" id="name" required><br><br>
  <input placeholder="Room" id="room" required><br><br>
  <input placeholder="Category" id="category" required><br><br>
  <textarea placeholder="Description" id="desc"></textarea><br><br>
  <button type="submit">Submit</button>
</form>

<p id="result" style="font-weight:bold;"></p>

<br>
<a href="/track">Go to Track Page</a> |
<a href="/logout">Logout</a>

<script>
document.getElementById("issueForm").addEventListener("submit", async function(e){
  e.preventDefault();

  const res = await fetch("/submit", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      student_name: document.getElementById("name").value,
      room_number: document.getElementById("room").value,
      category: document.getElementById("category").value,
      description: document.getElementById("desc").value
    })
  });

  const data = await res.json();

  if (!res.ok) {
    alert(data.detail);
    return;
  }

  // Clear form
  document.getElementById("issueForm").reset();

  // Show only Issue ID
  document.getElementById("result").innerText =
    "Your Issue ID is: " + data.issue_id;
});
</script>

</body>
</html>
